______________________________________________________________________________________________________________________________________________
                               
                                1. Registration & Account Activation via Email
                   verification-notification             

 ____________________________________________________________________________________________________________________________________________________________________
|          Step               |           Endpoint                 |Method|                  Description                                                             |
|-----------------------------|------------------------------------|------|------------------------------------------------------------------------------------------|
| 1.Register User             | /api/auth/register                 | POST | User submits name, email, and password to create an account. `email_verified_at = null`. |
|-----------------------------|------------------------------------|------|------------------------------------------------------------------------------------------|
| 2.Send Verification Email   | /api/auth/send-verification-email  | POST | Sends a verification email with a unique token link.                                     |
| 3.Click Verification Link   | /api/auth/verify-email?token=abc123| GET  | User clicks the verification link in the email, which opens a page.                      |
| 4.Enter Email/Phone for Code| /api/auth/request-verification-code| POST | User enters email/phone to receive a verification code.                                  |
|-----------------------------|------------------------------------|------|------------------------------------------------------------------------------------------|
| 5.Receive Verification Code | (Sent via email/SMS)               |      | System sends a 6-digit code for verification.                                            |
| 5.then user redirected to   | /api/auth/enter/verification-code  | Get  | this for submits to /api/auth/verify-code                                                |
|-----------------------------|------------------------------------|------|------------------------------------------------------------------------------------------|
| 6.Enter Verification Code   | /api/auth/verify-code              | POST | User submits the verification code for validation.                                       |
| 7.Activate Account          | (Handled in previous step)         |      | System verifies the code and updates `email_verified_at = now()`.                        |
|-----------------------------|------------------------------------|------|------------------------------------------------------------------------------------------|
| 8.Log In                    | /api/auth/login                    | POST | User logs in with email and password and receives a JWT token.                           |
| 8.Check-email-verification  | /api/auth/check-email-verification | GET  | Checks whether the user's email is verified.                                             |
| 8.Change-email              | /api/auth/change-email             | POST | Allows a user to change their email and request verification again.                      |
|_____________________________|____________________________________|______|__________________________________________________________________________________________|
                               
_______________________________________________________________________________________________________________________________________________
                               
                                Registration & Account Activation Workflow via Email  

This workflow describes how users register, verify their email, and manage their account activation securely.  

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1️⃣ User Registration  
Used When: A new user signs up.  

Flow:  
1. User submits request → (((((((((((((POST /api/auth/register))))))))))))) with name, email, and password.  
2. System creates the account and sets email_verified_at = null.  
3. System sends a verification email → ((((((((((((((POST /api/auth/send-verification-email)))))))))))))).
4. this email contains verification link -> (((((((((((Get /api/auth/verify-email))))))))))).
5. User clicks on the verification link, and this will display
    a form and the user will enter his email or phone that will receicve the account verification code.
6. User enters the verification code and submits the form to -> ((((((((((Get /api/auth/verification-code)))))))))).
7. then Redirects the user to ->((((((( Get /api/auth/enter-verification-code))))))).
7. System verifies the code and activates the user account by setting email_verified_at = now().
8. User can now log in to their account.

_____________________________________________________________________________________________________________________________

 1️⃣ User Registration Flow  

 Step 1: User Registers an Account
- Endpoint: `POST /api/auth/register`
- Request Body:
  ``````````````````````````````````````````````````````json
  {
    "name": "John Doe",
    "email": "john@example.com",
    "password": "securepassword"
  }
  ``````````````````````````````````````````````````````
- System Action:  
  ✅ Creates the user in the database.  
  ✅ Sets `email_verified_at = null`.  
  ✅ Sends a verification email.

---------------------------------------------------------------------------

 Step 2: Send Verification Email
- Endpoint: `POST /api/auth/send-verification-email`
- Request Body: (User's email)
  ``````````````````````````````````````````````````````json
  {
    "email": "john@example.com"
  }
  ``````````````````````````````````````````````````````
- System Action:  
  ✅ Generates a verification token.  
  ✅ Sends an email with a verification link.

---------------------------------------------------------------------------

 Step 3: Email Contains Verification Link
- Verification Link:  
  ``````````````````````````````````````````````````````
  GET /api/auth/verify-email?token=abc123
  ``````````````````````````````````````````````````````

---------------------------------------------------------------------------

 Step 4: User Clicks the Verification Link
- Endpoint: `GET /api/auth/verify-email?token=abc123`
- System Action:  
  ✅ Displays a form where the user enters their email or phone.  

---------------------------------------------------------------------------

 Step 5: User Enters Email or Phone
- Endpoint: `POST /api/auth/request-verification-code`
- Request Body:
  ``````````````````````````````````````````````````````json
  {
    "email": "john@example.com"
  }
  ``````````````````````````````````````````````````````
- System Action:  
  ✅ Sends a verification code via email/SMS.  
  ✅ Redirects the user to the code entry page.

---------------------------------------------------------------------------

 Step 6: User Enters Verification Code
- Endpoint: `POST /api/auth/verify-code`
- Request Body:
  ``````````````````````````````````````````````````````json
  {
    "email": "john@example.com",
    "code": "123456"
  }
  ``````````````````````````````````````````````````````
- System Action:  
  ✅ Verifies the code.  
  ✅ Activates the account (`email_verified_at = now()`).  
  ✅ Redirects to login.

---------------------------------------------------------------------------

 Step 7: User Can Log In
- Endpoint: `POST /api/auth/login`
- Request Body:
  ``````````````````````````````````````````````````````json
  {
    "email": "john@example.com",
    "password": "securepassword"
  }
  ``````````````````````````````````````````````````````
- System Action:  
  ✅ Logs in the user and returns a JWT token.







_____________________________________________________________________________________________________________________________________________
 More Secure Verification Code Handling:  
   - Use rate limits to prevent brute-force attacks.  
   - Codes should expire after 5-10 minutes.  
   - Support both email & phone verification for flexibility.  
 Security Enhancements
✅ Verification Link Expiry: Set verification links to expire after X minutes.  
✅ Rate Limiting: Limit verification email resends to prevent abuse.  
✅ Prevent Unverified Logins: Restrict access to features until the email is verified.  
✅ Notify on Email Change: Send an email alert to the old address when the email is changed.  

_____________________________________________________________________________________________________________________________________________